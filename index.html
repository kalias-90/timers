<html>
    <head>
        <title>Timers</title>
        <style type="text/css">
            body {
                background: #60d7e2;
                font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
                font-size: 1.5em;
                margin: 0;
                color:#383430;
            }
            button, input {
                font-size: inherit;
            }
            main {
                max-width: 500px;
                margin: 20px auto 0 auto;
            }
            ul#timers {
                list-style: none;
                padding: 10px;
                background: #d3ecee;
                border: 3px solid #5e8b8f;
            }
            ul#timers>li {
                border-left: 10px solid #e68dc1;
                padding: 5px 0px 5px 10px;
            }
            ul#timers>li:nth-child(even) {
                border-left-color: #a6b1e2;
            }
        </style>
    </head>
    <body>
        <script>
            class Timer {
                constructor (name, onTick, onResume, onPause) {
                    this.name = name;
                    this.seconds = 0;
                    this.paused = false;

                    this.onTick = () => onTick(
                        this.seconds/3600>>0,
                        this.seconds%3600/60>>0,
                        this.seconds%3600%60
                    );
                    this.onResume = onResume;
                    this.onPause = onPause;

                    Timer.list.forEach((timer) => {
                        timer.pause();
                    });
                    Timer.list.push(this);

                    this.resume();
                    this.onTick();
                }

                static list = [];
                static clock = setInterval(() => {
                    Timer.list.forEach((timer) => timer.tick());
                }, 1000);
                
                resume () {
                    this.paused = false;
                    this.onResume();
                }

                tick () {
                    if (!this.paused) {
                        this.seconds++;
                        this.onTick();
                    }
                }
                
                pause () {
                    this.paused = true;
                    this.onPause();
                }
            }
        </script>

        <main>
            <input id="newTimerName"/>
            <button id="createTimer">Create</button>

            <ul id="timers"></ul>

            <template id="timerTemplate" class="timer">
                <span class="name">${timerName}</span>
                <span class="time"></span>
                <button class="resume" disabled>Resume</button>
                <button class="pause" disabled>Pause</button>
            </template>
        </main>

        <script>
            document.addEventListener('DOMContentLoaded', () => {
                const nameInput = document.getElementById('newTimerName');
                const timersContainer = document.getElementById('timers');
                const timerTemplate = document.getElementById('timerTemplate');
                const timerCreate = document.getElementById('createTimer');

                timerCreate.addEventListener('click', () => {
                    const name = nameInput.value;
                    nameInput.value = "";

                    const timerElement = document.createElement('li');
                    timerElement.class = 'timer';
                    timerElement.innerHTML = timerTemplate.innerHTML.replace('${timerName}', name);
                    const timeLabel = timerElement.querySelector('span.time');
                    const resumeButton = timerElement.querySelector('button.resume');
                    const pauseButton = timerElement.querySelector('button.pause');

                    const timer = new Timer(
                        name,
                        (h, m, s) => {
                            timeLabel.textContent = `${h}h ${m}m ${s}s`;
                        },
                        () => {
                            resumeButton.disabled = true;
                            pauseButton.disabled = false;
                        },
                        () => {
                            resumeButton.disabled = false;
                            pauseButton.disabled = true;
                        }
                    );
                    
                    resumeButton.addEventListener('click', (e) => {
                        timer.resume();
                        resumeButton.disabled = true;
                        pauseButton.disabled = false;
                    });
                    pauseButton.addEventListener('click', (e) => {
                        timer.pause();
                        resumeButton.disabled = false;
                        pauseButton.disabled = true;
                    });
                    
                    timersContainer.prepend(timerElement);
                });
            });
        </script>
    </body>
</html>